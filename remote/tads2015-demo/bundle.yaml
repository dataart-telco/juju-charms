series: trusty
services:
  mesos-master:
    charm: cs:~tads2015dataart/trusty/mesos-master-0
    num_units: 1
    exposed: true
    constraints: "mem=1G"
    annotations:
      gui-x: "1140"
      gui-y: "570"
  mesos-slave: 
    charm: cs:~tads2015dataart/trusty/mesos-slave-0
    num_units: 2
    expose: true
    constraints: "mem=1G"
    annotations: 
      gui-x: "1140"
      gui-y: "950"
  calls-consumer:
    charm: cs:~tads2015dataart/trusty/tads2015-calls-consumer-4mesos-4      
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
      PHONE_NUMBER: "5555"
      DID_DOMAIN: "80.250.109.132"
    annotations:
      gui-x: "1710"
      gui-y: "190"
  conference-call:
    charm: cs:~tads2015dataart/trusty/tads2015-conference-call-4mesos-2
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
    annotations:
      gui-x: "1710"
      gui-y: "570"
  sms-feedback:
    charm: cs:~tads2015dataart/trusty/tads2015-sms-feedback-4mesos-4
    options:
      RESTCOMM_PASSWORD: "42d8aa7cde9c78c4757862d84620c335"
      DID_DOMAIN: ""
    annotations:
      gui-x: "1710"
      gui-y: "950"
  redis-master:
    charm: cs:~mbruzek/trusty/redis-master-0
    num_units: 1
    expose: true
    annotations:
      gui-x: "2280"
      gui-y: "760"
  telscale-restcomm:
    charm: cs:~tads2015dataart/trusty/telscale-restcomm-3
    num_units: 1
    expose: true
    constraints: "mem=1536M"
    options:
      sms_proxy: "54.174.171.104"
      init_password: "42d8aa7cde9c78c4757862d84620c335"
      voicerss_key: "29b2d893df9f454abbfae94df6cff95b"
    annotations:
      gui-x: "2280"
      gui-y: "0"
  haproxy:
    charm: cs:trusty/haproxy-11
    num_units: 1
    expose: true
    options:
      services: "[]"
    annotations:
      gui-x: "2280"
      gui-y: "380"
#    juju-gui:
#      charm: cs:trusty/juju-gui-39
#      expose: true
#      annotations:
#        "gui-x": 0
#        "gui-y": 570
  monitor-server:
    charm: cs:~tads2015dataart/trusty/monitor-server-5
    num_units: 1
    expose: true
    constraints: "mem=512M"
    annotations:
      gui-x: "380"
      gui-y: "570"
    options:
      CHECK_PERIOD: 60
      JUJU_SCALE_DOWN: 37
      MESOS_SCALE_DOWN: 10
  monitor-db:
    charm: cs:~mbruzek/trusty/redis-master-0
    num_units: 1
    expose: true
    annotations:
      gui-x: "380"
      gui-y: "190"             
  monitor-agent-mesos:
    charm: cs:~tads2015dataart/trusty/monitor-agent-mesos-2
    annotations:
      gui-x: "760"
      gui-y: "950"
  monitor-agent-mesos-master:
    charm: cs:~tads2015dataart/trusty/monitor-agent-mesos-master-2
    annotations:
      gui-x: "760"
      gui-y: "190"
relations:
# callc consumer
  - - calls-consumer:redis
    - redis-master:db
  - - calls-consumer:restcomm
    - telscale-restcomm:website
  - - haproxy:reverseproxy
    - calls-consumer:haproxy
  - - calls-consumer
    - mesos-master
# end 
# conference
  - - conference-call:redis
    - redis-master:db
  - - conference-call:restcomm
    - telscale-restcomm:website
  - - haproxy:reverseproxy
    - conference-call:haproxy
  - - conference-call
    - mesos-master
# end
# conference
  - - sms-feedback:redis
    - redis-master:db
  - - sms-feedback:restcomm
    - telscale-restcomm:website
  - - haproxy:reverseproxy
    - sms-feedback:haproxy
  - - sms-feedback
    - mesos-master
# end
# monitor server
  - - monitor-server:redis
    - monitor-db:redis-master
#    - - monitor-server:api-server
#      - juju-gui:web
# end
# mesos cluster
  - - mesos-master
    - mesos-slave
  - - monitor-agent-mesos:monitor-server
    - monitor-server:monitor-server
  - - monitor-agent-mesos
    - mesos-master
  - - monitor-agent-mesos
    - mesos-slave  
  - - monitor-agent-mesos-master:monitor-server
    - monitor-server:monitor-server
  - - monitor-agent-mesos-master
    - mesos-master  
  - - monitor-server
    - mesos-master
# end
